<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>

  <script>

    const asyncRouterMap = [
      {
        path: "",
        name: "news",
        children: [
          {
            path: "/dog",
            name: '/dog',
            meta: { permission: '' }
          },
          {
            path: "/name",
            name: '/name',
            meta: { permission: '' }
          }

        ]
      },
      {
        path: "",
        name: "gongyuan",
        children: [
          {
            path: "/shu",
            name: 'shu',
            meta: { permission: '' }
          }

        ]
      },
    ];

    const permission = [
      {
        path: "/news",
        children: [
          {
            path: '/dog',
            permission: 3,
          }
        ]
      },
      {
        path: "/gongyuan",
        children: [
          {
            path: '/shu',
            permission: 5,
          }
        ]
      }
    ]

    function routerMatch(permission, asyncRouter) {
      return new Promise(resolve => {
        const routers = [];
        // 创建路由
        function createRouter(permission) {
          // 根据路径匹配到的router对象添加到routers中即可
          permission.forEach(item => {
            if (item.children && item.children.length) {
              createRouter(item.children);
            }
            let path = item.path;
            // 循环异步路由，将符合权限列表的路由加入到routers中
            asyncRouter.find(s => {
              if (s.path === "") {
                s.children.find(y => {
                  if (y.path === path) {
                    y.meta.permission = item.permission;
                    routers.push(s);
                  }
                });
              }
              if (s.path === path) {
                s.meta.permission = item.permission;
                routers.push(s);
              }
            });
          });
        }

        createRouter(permission);
        resolve([routers]);
      });
    }

    routerMatch(permission, asyncRouterMap).then((res) => {
      console.log(res);
    });

  </script>

</body>

</html>